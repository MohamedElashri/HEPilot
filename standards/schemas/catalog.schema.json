{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/MohamedElashri/HEPilot/standards/schemas/catalog.schema.json",
  "title": "Processing Catalog",
  "description": "Master catalog of all processed documents and their chunks. This file (catalog.json) serves as the entry point for discovering what documents have been processed and where their outputs are located. The catalog provides aggregate statistics and references to individual document outputs. If a document produces more than 128 chunks, the adapter MAY bundle the entire document subtree into document_{id}.tar.zst and reference that tarball in the file_path field.",
  "type": "object",
  "required": [
    "creation_timestamp",
    "adapter_version",
    "total_documents",
    "total_chunks",
    "documents"
  ],
  "properties": {
    "creation_timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when this catalog was created or last updated. Used to track catalog freshness and determine when reindexing is needed."
    },
    "adapter_version": {
      "type": "string",
      "description": "Version of the adapter that created this catalog. MUST follow semantic versioning (MAJOR.MINOR.PATCH). Used to track compatibility and determine if reprocessing is needed when adapter version changes."
    },
    "total_documents": {
      "type": "integer",
      "description": "Total number of documents successfully processed and cataloged. Used for progress tracking and capacity planning."
    },
    "total_chunks": {
      "type": "integer",
      "description": "Total number of chunks across all documents. Sum of chunk_count for all documents in the catalog. Used for embedding cost estimation and index sizing."
    },
    "source_distribution": {
      "type": "object",
      "description": "Breakdown of document counts by source type. Optional field providing quick statistics on corpus composition. Sum of all values SHOULD equal total_documents.",
      "properties": {
        "arxiv": {
          "type": "integer",
          "description": "Number of documents from arXiv."
        },
        "indico": {
          "type": "integer",
          "description": "Number of documents from Indico conference systems."
        },
        "internal_notes": {
          "type": "integer",
          "description": "Number of internal technical notes or reports."
        },
        "twiki": {
          "type": "integer",
          "description": "Number of documents from TWiki or similar wiki systems."
        },
        "other": {
          "type": "integer",
          "description": "Number of documents from other sources not classified above."
        }
      },
      "additionalProperties": false
    },
    "documents": {
      "type": "array",
      "description": "Array of document entries, one per successfully processed document. Each entry provides summary information and path to full document metadata and chunks.",
      "items": {
        "type": "object",
        "required": [
          "document_id",
          "source_type",
          "title",
          "chunk_count",
          "file_path"
        ],
        "properties": {
          "document_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for this document. Used to locate the document's directory in the output tree."
          },
          "source_type": {
            "type": "string",
            "description": "Source type of this document (arxiv, indico, internal_notes, twiki, other). Used for filtering and source-specific processing."
          },
          "title": {
            "type": "string",
            "description": "Document title for display and search purposes. SHOULD match the title in document_metadata.json."
          },
          "chunk_count": {
            "type": "integer",
            "description": "Number of chunks this document was split into. If this exceeds 128, the document MAY be stored as a compressed tarball instead of individual files."
          },
          "file_path": {
            "type": "string",
            "description": "Path to the document's output directory or tarball. For individual files: path to directory containing chunks/, document_metadata.json, etc. For compressed output (>128 chunks): path to document_{id}.tar.zst tarball. SHOULD use virtual URI scheme (adp://{bucket}/{key}) to abstract storage location."
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
